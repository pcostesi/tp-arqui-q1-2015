#include <screensaver.h>
#include <video.h>

#define MATRIX (sizeof(animatrix) / sizeof(animatrix[0]))

static char * animatrix[4][25] = {
	{
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		0
	},
	{
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - OBEY\\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		0
	},
	{
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		0
	},
	{
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - MSFT| - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		"/ \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | / \\ - | ",
		"- | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / - | \\ / ",
		"\\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - \\ / | - ",
		"| - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ | - / \\ ",
		0
	}
};

static unsigned int scrsvr_delay = 10;

void scrsvr_set_delay(unsigned int delay)
{
	scrsvr_delay = delay;
}

int scrsvr_should_show(unsigned int seconds)
{
	return seconds > (scrsvr_delay * 1000 / TICK);
}

void scrsvr_tick(unsigned int tick)
{
	vid_clr();
	char ** screen = animatrix[tick % MATRIX];
	char i = 0;
	while (screen[i] != 0) {
		char len = 0;
		while (screen[i][len++] != '\0');
		vid_print(screen[i], len - 1);
		if (len - 1 < 80) {
			vid_print("\n", 1);
		}
		i++;
	}
}
